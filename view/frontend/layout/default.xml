<?xml version="1.0"?>
<page xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="urn:magento:framework:View/Layout/etc/page_configuration.xsd">
	<body>
		<!-- First remove the default header wrapper -->
		<referenceContainer name="header.container">
			<referenceBlock name="header-wrapper" remove="true"/>
		</referenceContainer>
		
		<!-- Wait for everything to be moved, then add our custom header at the end of header.container -->
		<referenceContainer name="header.container">
			<block class="CravenDunnill\Header\Block\Html\Header" name="custom.header" template="CravenDunnill_Header::html/header.phtml" after="-">
				<arguments>
					<argument name="jsLayout" xsi:type="array">
						<item name="components" xsi:type="array">
							<item name="minicart_content" xsi:type="array">
								<item name="component" xsi:type="string">Magento_Checkout/js/view/minicart</item>
								<item name="config" xsi:type="array">
									<item name="template" xsi:type="string">Magento_Checkout/minicart/content</item>
								</item>
								<item name="children" xsi:type="array">
									<item name="subtotal.container" xsi:type="array">
										<item name="component" xsi:type="string">Magento_Checkout/js/view/checkout/minicart/subtotal/totals</item>
										<item name="provider" xsi:type="string">totalsData</item>
									</item>
									<item name="extra_info" xsi:type="array">
										<item name="component" xsi:type="string">Magento_Checkout/js/view/checkout/minicart/extra-info</item>
									</item>
									<item name="promotion" xsi:type="array">
										<item name="component" xsi:type="string">Magento_Checkout/js/view/checkout/minicart/promotion</item>
									</item>
									<item name="item.renderer" xsi:type="array">
										<item name="component" xsi:type="string">Magento_Checkout/js/view/checkout/minicart/item/default</item>
										<item name="config" xsi:type="array">
											<item name="template" xsi:type="string">Magento_Checkout/minicart/item/default</item>
										</item>
										<item name="children" xsi:type="array">
											<item name="item.image" xsi:type="array">
												<item name="component" xsi:type="string">Magento_Catalog/js/view/image</item>
												<item name="config" xsi:type="array">
													<item name="template" xsi:type="string">Magento_Catalog/product/image</item>
													<item name="displayArea" xsi:type="string">itemImage</item>
												</item>
											</item>
										</item>
									</item>
								</item>
							</item>
						</item>
					</argument>
				</arguments>
			</block>
		</referenceContainer>
		
		<!-- Make sure Magento's standard minicart is also available -->
		<referenceBlock name="minicart">
			<arguments>
				<argument name="jsLayout" xsi:type="array">
					<item name="components" xsi:type="array">
						<item name="minicart_content" xsi:type="array">
							<item name="children" xsi:type="array">
								<item name="item.renderer" xsi:type="array">
									<item name="config" xsi:type="array">
										<item name="displayArea" xsi:type="string">defaultRenderer</item>
									</item>
								</item>
							</item>
						</item>
					</item>
				</argument>
			</arguments>
		</referenceBlock>
	</body>
</page>